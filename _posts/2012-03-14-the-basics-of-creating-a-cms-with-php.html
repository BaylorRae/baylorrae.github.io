---
layout: post
title: The Basics of Creating a CMS with PHP
date: 2012-03-14 08:00:27.000000000 -05:00
categories:
- PHP
- Tutorials
tags:
- application architecture
- cms
- content management system
- pdo
- php
- tutorial
meta:
  dsq_thread_id: '832826303'
---
<p>When people want to build a website for someone, they usually need to create a<br />
Content Management System (CMS) that allows the client to manage their own<br />
content. And while there are thousands of prebuilt CMSes that can get the job<br />
done, it can be very helpful to learn how to build one yourself.</p>
<h2>What a CMS should do</h2>
<p>They don&#39;t have to be extremely difficult and should only do as much as needed.<br />
If your grandmother wants a website to sell pies, then she only needs a way to<br />
add, update and remove various flavors.</p>
<h2>How a CMS should work</h2>
<p>There are two popular methods (that I&#39;m aware of) for creating content<br />
management systems. The first uses a separate area for all administrative<br />
controls. This is my personal choice because it allows the admin area to scale<br />
and provide more features.</p>
<p>The second is what I would call an inline approach, where all backend controls<br />
are done inside the same frontend website. Implementing this approach it<br />
helps keep your code DRY (don&#39;t repeat yourself) by keeping you from writing<br />
the code to display pages and content twice.</p>
<p>Each of of these methods have their benefits and detriments. By separating the<br />
administrative controls you have to rewrite most of the code to display the<br />
content again. But, when using an inline approach it&#39;s difficult to add a page<br />
to statistically show popular products (or pies). As a result, every website will need a<br />
system tailored to improve the usability for the client.</p>
<h2>Getting Started</h2>
<p>The CMS we will be creating will be more of an inline approach. It will be a very basic site that allows me to store a list of my favorite websites.</p>
<p>Therefore we only need three pages.</p>
<ol>
<li>A home page that shows all of my favorite websites.</li>
<li>A form to that lets us create and edit websites.</li>
<li>A page that deletes a website from our list.</li>
</ol>
<p>This is the file structure that I&#39;ve chosen for our CMS. We will be creating<br />
more files later on, but this should be plenty to get you started.</p>
<p>[gist id=3850401 file=file_structure.txt]</p>
<p>
{% gist baylorrae/3850401 file_structure.txt %}
</p>
<h2>Creating our Database</h2>
<p>We won&#39;t be creating a large database for this tutorial. We only want to provide<br />
an easy way to manage our favorite websites.</p>
<p>[gist id=3850401 file=websites.sql]</p>
<p>This table will hold all the information we need about our favorite website.<br />
Where to access it (the url field), what the title is, and who is the primary<br />
author on the website.</p>
<p>This article is not designed to teach you SQL, so you may need to copy and<br />
paste your way through for the time being. <a href="http://www.w3schools.com/sql/default.asp">W3 Schools has some SQL tutorials</a><br />
that you may find helpful.</p>
<h2>Connecting to the Database with PDO</h2>
<p>PHP offers multiple interfaces for connecting and interacting with databases,<br />
but I think we&#39;ll find <a href="http://php.net/pdo">PHP Data Objects</a> the easiest to use.</p>
<p>[gist id=3850401 file=global.php]</p>
<h2>Add Some Data</h2>
<p>To make it easier for us begin working with our database we need some<br />
information. The code below will go ahead an insert two rows into our table with<br />
some websites that I like.</p>
<p>[gist id=3850401 file=index-preview.php]</p>
<h2>Displaying our Favorite Websites</h2>
<p>Now that <code>index.php</code> has been cleared we can go ahead and add the code that we<br />
need to make this website functional.</p>
<p>[gist id=3850401 file=index.php]</p>
<p>This is all we need for our website class</p>
<p>[gist id=3850401 file=modelswebsite.php]</p>
<h2>Creating the Form</h2>
<p>We are going to create a single file for the form because it will be used when<br />
adding and editing website details.</p>
<p>[gist id=3850401 file=_form.php]</p>
<p>There are two important things to note inside of our form.</p>
<ol>
<li>Each input is set into a <code>website[]</code> array</li>
<li>The file requires us to have a <code>$website</code> variable</li>
</ol>
<p>[gist id=3850401 file=new.php]</p>
<p>Notice how we check to see if a form has been submitted right at the beginning.<br />
This let&#39;s us choose whether we want to try and insert a new row or display<br />
the form.</p>
<p>Both sides of the <code>if</code> statement create the <code>$website</code> variable for the form.<br />
This is cool because it will automatically fill in the inputs if the value has<br />
been added to the object.</p>
<h2>Editing a Website</h2>
<p>The first thing we need to do is add a link to <code>edit.php</code></p>
<p>[gist id=3850401 file=edit-link.php]</p>
<p>This will create a link to <code>edit.php?id=xxx</code> which we will be able to grab with<br />
<code>$_GET[&#39;id&#39;]</code>.</p>
<p>[gist id=3850401 file=edit.php]</p>
<p>This requires a little more logic than when inserting a new record because we<br />
have to find a current record and then update it.</p>
<p>Most of what I&#39;ve done in this file is the same as the last few examples,<br />
perhaps the most complex part is at</p>
<p>[gist id=3850422 file=complex-line.php]</p>
<p>basically it&#39;s concatenating the two arrays together resulting in</p>
<p>[gist id=3850422 file=complex-line-result.php]</p>
<h2>Deleting Records</h2>
<p>The first thing we need to do is add a link to <code>delete.php</code> in <code>index.php</code></p>
<p>[gist id=3850422 file=delete-link.php]</p>
<p>[gist id=3850422 file=delete.php]</p>
<p>There really isn&#39;t anything really special in this part. Once you&#39;ve added a<br />
page for inserting and updating, deleting is as easy is falling off a log.</p>
<h2>Conclusion</h2>
<p>The hardest part of creating a CMS is learning the SQL, which means you&#39;ll have<br />
to practice, practice, practice. Once you have a basic understanding of how to<br />
write/run different queries based on what needs to be done you&#39;ll be good to go.</p>
<p>For practice I recommend creating a few basic websites to challenge yourself.<br />
A blog that has posts, comments and categories would be a great start.</p>
