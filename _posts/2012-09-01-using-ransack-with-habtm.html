---
layout: post
title: Using Ransack with HABTM
date: 2012-09-01 08:00:00.000000000 -05:00
categories:
- Filter Records
- has_many :through
- Rails
tags:
- filter records
- has_many through
- rails
- ransack
meta:
  dsq_thread_id: '832222202'
---
<p>If you&#39;re unfamiliar with <a href="https://github.com/ernie/ransack">Ransack</a>, it&#39;s basically an advanced search form generator for Rails. It allows you to add fields to the form for things like <code>category_id_eq</code> and <code>title_cont</code> and it will &quot;magically&quot; query the database.</p>
<p>The only real problem with Ransack is the lack of documentation. Almost every time I had a problem I ended up looking on <a href="http://stackoverflow.com/questions/tagged/ransack">Stack Overflow</a> or through the <a href="https://github.com/ernie/ransack/issues">Github Issues</a> page. Both of those sites are easy to search through which wasn&#39;t a hindrance, but it took a long time to figure out simple things.</p>
<p>One of those simple things, which <a href="http://stackoverflow.com/q/11619246/467546">I&#39;m not the only one</a> that had a problem with, was creating a select field for a <code>has_many :through</code> or <code>has_and_belongs_to_many</code> association.</p>
<h2>The Setup</h2>
<p>Here are the three models that I have in place. It&#39;s a basic setup for <code>has_many :through</code> allowing multiple categories being assigned to products and vice versa. For more information take a look at <a href="http://guides.rubyonrails.org/association_basics.html#the-has_many-through-association">Rails Guide on ActiveRecord associations</a>.</p>
<p><script src="https://gist.github.com/BaylorRae/3572342.js?file=models.rb"></script></p>
<h2>The Ransack Way</h2>
<p>For Ransack to pick up on the association you have to provide the &quot;associated&quot; models plural name. For instance, if we are building a search form for the products page then the field name would be <code><strong>categories</strong>_id_eq</code>. Here&#39;s an example form</p>
<p><script src="https://gist.github.com/BaylorRae/3572342.js?file=ransack_search_form.html.erb"></script></p>
